@RestController
@RequestMapping("/orders")
public class MyController {

    @Autowired
    private Repository repository;

    @GetMapping("/{orderId}")
    public ResponseEntity<Order> getOrderById(@PathVariable Integer orderId) {
        Order order = repository.findById(orderId)
                .orElseThrow(() -> new RuntimeException("Order not found"));

        return ResponseEntity.ok(order);
    }

    @PostMapping
    public ResponseEntity<Order> createOrder(@RequestBody Order order) {
        Order savedOrder = repository.save(order);
        return ResponseEntity.status(HttpStatus.CREATED).body(savedOrder);
    }

    @PutMapping("/{orderId}")
    public ResponseEntity<Order> updateOrder(@PathVariable Integer orderId,
                                             @RequestBody Order order) {

        // ensure ID match (optional but best practice)
        order.setId(orderId);

        Order updatedOrder = repository.save(order);
        return ResponseEntity.ok(updatedOrder);
    }

    @PatchMapping("/{orderId}")
    public ResponseEntity<Order> partialUpdateOrder(@PathVariable Integer orderId,
                                                    @RequestBody Order order) {

        Order existing = repository.findById(orderId)
                .orElseThrow(() -> new RuntimeException("Order not found"));

        // Patch only fields that are not null (example)
        if (order.getName() != null) {
            existing.setName(order.getName());
        }
        // add other partial fields here...

        Order updatedOrder = repository.save(existing);
        return ResponseEntity.ok(updatedOrder);
    }

    @DeleteMapping("/{orderId}")
    public ResponseEntity<String> deleteOrder(@PathVariable Integer orderId) {
        repository.deleteById(orderId);
        return ResponseEntity.ok("Order deleted successfully");
    }
}
